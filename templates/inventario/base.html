{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Jugoso Market{% endblock %}</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@1.9.12" crossorigin="anonymous"></script>

  <!-- Alpine (opcional) -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <style>
    /* ========= Sistema de variables claro/oscuro ========== */
    :root{
      --brand: #ef7f1a;
      --brand-600:#ea6a00;
      --brand-700:#c15700;

      --bg: #f8fafc;
      --panel: #ffffff;
      --panel-border: #e5e7eb;
      --text: #0f172a;
      --muted: #64748b;

      --table-row: #fcfcfd;
      --ring: rgba(239,127,26,0.25);
    }
    html.dark{
      --bg: #0b1220;
      --panel: #0f172a;
      --panel-border: #1e293b;
      --text: #e2e8f0;
      --muted: #94a3b8;

      --table-row: #0d182b;
      --ring: rgba(239,127,26,0.35);
    }

    /* ========= Componentes reutilizables ========= */
    .btn{
      display:inline-flex; align-items:center; gap:.5rem;
      padding:.55rem .9rem; border:1px solid var(--panel-border);
      border-radius:9999px; background:var(--panel); color:var(--text);
      text-decoration:none; transition:box-shadow .15s, transform .02s, background .15s, border-color .15s;
    }
    .btn:hover{ background:rgba(255,255,255,.75); }
    html.dark .btn:hover{ background:#162033; }
    .btn:active{ transform:translateY(1px); }

    .btn-primary{
      border-color:var(--brand); background:var(--brand); color:#fff;
    }
    .btn-primary:hover{ background:var(--brand-600); }
    .btn-primary:active{ background:var(--brand-700); }

    .btn-ghost{
      border-color:transparent; background:transparent;
    }
    .btn-ghost:hover{
      background:#f1f5f9;
    }
    html.dark .btn-ghost:hover{
      background:#0d182b;
    }

    .inp{
      border:1px solid var(--panel-border); border-radius:9999px; padding:.55rem .9rem;
      outline:none; width:100%; background:var(--panel); color:var(--text);
    }
    .inp:focus{ box-shadow:0 0 0 4px var(--ring); border-color:var(--brand); }

    .card{
      background:var(--panel); border:1px solid var(--panel-border);
      border-radius:1rem; box-shadow:0 8px 24px rgba(17,24,39,.06);
    }
    html.dark .card{ box-shadow:0 16px 40px rgba(0,0,0,.35); }

    .table{
      width:100%; border-collapse:separate; border-spacing:0; font-size:.95rem;
      border:1px solid var(--panel-border); border-radius:14px; overflow:hidden;
      color:var(--text);
    }
    .table thead th{
      background:#f8fafc; text-align:left; padding:.65rem .75rem; border-bottom:1px solid var(--panel-border);
    }
    html.dark .table thead th{ background:#0d182b; }
    .table tbody td{ padding:.6rem .75rem; border-bottom:1px solid var(--panel-border); }
    .table tbody tr:hover td{ background:var(--table-row); }

    .badge{ display:inline-block; padding:.15rem .5rem; border-radius:9999px; font-size:.75rem; border:1px solid; }
    .badge-ok{ color:#166534; background:#ecfdf5; border-color:#bbf7d0;}
    .badge-low{ color:#991b1b; background:#fef2f2; border-color:#fecaca;}

    .brand-text{ font-weight:700; font-size:1.05rem; letter-spacing:.1px; color:var(--brand); }
    .logo-img{ width:36px; height:36px; display:block; }

    /* ---- Campos de formulario visibles en claro/oscuro (global) ---- */
    input[type="text"], input[type="number"], input[type="email"], input[type="password"],
    input[type="tel"], input[type="url"], input[type="search"],
    select, textarea {
      width: 100%;
      background: var(--panel);
      color: var(--text);
      border: 1px solid var(--panel-border);
      border-radius: .65rem;
      padding: .65rem .85rem;
      outline: none;
    }
    input::placeholder, textarea::placeholder { color: var(--muted); opacity: 1; }
    select { color-scheme: dark; }
    option { background: var(--panel); color: var(--text); }
    input:focus, select:focus, textarea:focus {
      border-color: var(--brand);
      box-shadow: 0 0 0 4px var(--ring);
    }
    label { color: var(--text); }
    .helptext { color: var(--muted); font-size: .85rem; }
    .errorlist { color: #ef4444; margin:.25rem 0; }
    input[type="checkbox"], input[type="radio"] { accent-color: var(--brand); }
    button, input[type="submit"]{
      background: var(--brand);
      color: #fff;
      border: 1px solid var(--brand);
      border-radius: .7rem;
      padding: .6rem 1rem;
      cursor: pointer;
    }
    button:hover, input[type="submit"]:hover { background: var(--brand-600); }
    button:active, input[type="submit"]:active { background: var(--brand-700); }
  </style>

  <script>
    // ====== Preferencia inicial (por defecto: OSCURO) ======
    (function() {
      const stored = localStorage.getItem('theme');
      // Si NO hay preferencia guardada -> usa oscuro por defecto
      const useDark = stored ? (stored === 'dark') : true;
      document.documentElement.classList.toggle('dark', useDark);
    })();

    // ====== Toggle global ======
    function toggleTheme(){
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      const i = document.getElementById('themeIcon');
      i.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
      i.setAttribute('title', isDark ? 'Cambiar a claro' : 'Cambiar a oscuro');
    }

    document.addEventListener('DOMContentLoaded', () => {
      const isDark = document.documentElement.classList.contains('dark');
      const i = document.getElementById('themeIcon');
      if(i){
        i.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
        i.setAttribute('title', isDark ? 'Cambiar a claro' : 'Cambiar a oscuro');
      }
    });
  </script>
</head>

<body style="background:var(--bg); color:var(--text)">
  <!-- Header -->
  <header style="background:var(--panel); border-bottom:1px solid var(--panel-border);">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <!-- Logo inline + link a Home -->
      <a href="{% url 'inventario:home' %}" class="flex items-center gap-2" title="Ir al inicio" style="text-decoration:none">
        <!-- Logo inline (c√≠trico) -->
        <svg width="36" height="36" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg" aria-label="Jugoso Market" class="logo-img">
          <defs>
            <linearGradient id="grad" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#FFB347"/>
              <stop offset="1" stop-color="#FF7A00"/>
            </linearGradient>
            <linearGradient id="leaf" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#34D399"/>
              <stop offset="1" stop-color="#059669"/>
            </linearGradient>
          </defs>
          <circle cx="20" cy="20" r="16" fill="url(#grad)"/>
          <circle cx="14" cy="14" r="4.5" fill="white" opacity="0.5"/>
          <path d="M24 6 C30 5, 34 7, 35 11 C31 12, 27 10, 24 6 Z" fill="url(#leaf)"/>
          <path d="M16 26 C16 23, 20 22, 20 19 C20 22, 24 23, 24 26 C24 28.2091 22.2091 30 20 30 C17.7909 30 16 28.2091 16 26 Z" fill="#FFFFFF" opacity="0.85"/>
        </svg>
        <span class="brand-text">Jugoso Market</span>
      </a>

      <nav class="hidden md:flex gap-2 text-sm">
        <a class="btn btn-ghost" href="{% url 'inventario:categoria_list' %}">Categor√≠as</a>
        <a class="btn btn-ghost" href="{% url 'inventario:proveedor_list' %}">Proveedores</a>
        <a class="btn btn-ghost" href="{% url 'inventario:productos_list' %}">Productos</a>
        <a class="btn" href="{% url 'inventario:compra_nueva' %}">Compra</a>
        <a class="btn btn-primary" href="{% url 'inventario:pos_venta' %}">POS</a>
        <a class="btn btn-ghost" href="/admin/">Admin</a>

        <!-- Toggle tema -->
        <button type="button" class="btn btn-ghost" onclick="toggleTheme()">
          <span id="themeIcon" aria-hidden="true">üåô</span>
          <span class="sr-only">Cambiar tema</span>
        </button>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-6xl mx-auto px-4 py-6">
    {% if messages %}
      <div class="space-y-2 mb-4">
        {% for m in messages %}
          <div class="px-4 py-3 rounded-xl border"
               style="border-color: var(--panel-border);
                      background: {% if m.tags == 'success' %}rgba(16,185,129,.08){% elif 'error' in m.tags %}rgba(239,68,68,.08){% else %}rgba(245,158,11,.08){% endif %};
                      color: var(--text);">
            {{ m }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <!-- Footer con tu firma -->
  <footer class="text-center text-xs py-8" style="color:var(--muted);">
    Hecho por <strong>Richard Contreras</strong> ¬∑
    <a href="mailto:rcontreraslepilaf@gmail.com" class="underline" style="color:var(--muted)">rcontreraslepilaf@gmail.com</a> ¬∑
    2025
  </footer>
</body>
</html>

{# templates/inventario/partials/producto_preview.html #}
{% if p %}
<div
  x-data="{
      cantidad: 1,
      precio: {{ precio_base|default:0 }},
      get subtotal(){ return (Number(this.cantidad)||0) * (Number(this.precio)||0) }
  }"
  class="mt-3"
>
  <!-- Se envía el id en el submit final si tu handler lo usa -->
  <input type="hidden" name="producto_id" value="{{ p.id }}">

  <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
    <div>
      <label class="block text-sm mb-1">Cantidad</label>
      <input type="number" min="1" step="1" class="inp" name="cantidad" x-model.number="cantidad" value="1">
    </div>

    <div>
      <label class="block text-sm mb-1">Precio</label>
      <input type="number" min="0" step="0.01" class="inp" name="precio" x-model.number="precio">
      <p class="text-xs mt-1 text-slate-500">Precio base: <strong>${{ precio_base|floatformat:0 }}</strong></p>
    </div>

    <div>
      <label class="block text-sm mb-1">Subtotal</label>
      <div class="card px-3 py-2 flex items-center h-[42px]">
        <strong>$ <span x-text="subtotal.toLocaleString('es-CL')"></span></strong>
      </div>
    </div>
  </div>

  <p class="text-xs mt-2 text-slate-500">
    * Edita cantidad/precio antes de agregar. El subtotal se calcula automáticamente.
  </p>
</div>
{% else %}
  <p class="text-sm mt-2 text-slate-400">Producto no encontrado. Escribe el <strong>código</strong> o parte del <strong>nombre</strong>.</p>
{% endif %}

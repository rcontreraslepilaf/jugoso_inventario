{% extends "inventario/base.html" %}
{% block title %}Ventas{% endblock %}

{% block content %}
<style>
  .tbl { width: 100%; border-collapse: collapse; }
  .tbl th, .tbl td { padding: .9rem 1rem; border-bottom: 1px solid rgba(255,255,255,.08); }
  .tbl th { text-align: left; opacity: .9; font-weight: 600; }
  .tbl td.num { text-align: right; }
  .card { border-radius: 1rem; background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.06); }
  .card-h { padding: 1rem 1.25rem; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid rgba(255,255,255,.06); }
  .card-b { padding: 1.25rem; }
</style>

<div class="card">
  <div class="card-h">
    <div style="font-weight:700;">Ventas</div>
    <div style="display:flex; gap:.6rem;">
      <a href="{% url 'inventario:pos_venta' %}" class="btn btn-primary">+ Nueva venta</a>
      <a href="{% url 'inventario:home' %}" class="btn btn-secondary"><span class="i i-home"></span> Inicio</a>
    </div>
  </div>

  <div class="card-b">
    <table class="tbl">
      <thead>
        <tr>
          <th style="width:10%;">N°</th>
          <th>Fecha</th>
          <th style="width:12%; text-align:center;">Ítems</th>
          <th style="width:18%;" class="num">Total</th>
          <th style="width:14%; text-align:center;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for v in ventas %}
          <tr>
            <td>{{ v.id }}</td>
            <td>{% if v.fecha %}{{ v.fecha|date:"d \\d\\e F \\d\\e Y \\a \\l\\a\\s H:i" }}{% else %}—{% endif %}</td>
            <td style="text-align:center;">{{ v.items|default:"—" }}</td>
            <td class="num">
              {% if v.total %}${{ v.total|floatformat:"0" }}{% else %}$0{% endif %}
            </td>
            <td style="text-align:center;">
              <a class="btn btn-secondary btn-sm" href="{% url 'inventario:ventas_detalle' v.id %}">Ver</a>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="5">Sin ventas registradas.</td></tr>
        {% endfor %}
      </tbody>
    </table>

    {% if page_obj and page_obj.paginator.num_pages > 1 %}
      <div class="pager" style="display:flex; gap:.6rem; justify-content:center; margin-top:1rem;">
        {% if page_obj.has_previous %}<a class="btn btn-secondary btn-sm" href="?page={{ page_obj.previous_page_number }}">« Anterior</a>{% endif %}
        <div class="pill btn-soft">Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</div>
        {% if page_obj.has_next %}<a class="btn btn-secondary btn-sm" href="?page={{ page_obj.next_page_number }}">Siguiente »</a>{% endif %}
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
